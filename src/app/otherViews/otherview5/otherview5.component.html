
<h3 class="">Candidate Selection Metrics  </h3>
<div class="relative inline-block">
  <button (click)="toggleFilters()" class="filter-btn">
    <span>Filter</span>
    <span *ngIf="showFilters">&#9650;</span>
    <span *ngIf="!showFilters">&#9660;</span>
  </button>


    <div *ngIf="showFilters" class="filterclass">
        <!-- Quarterly Selection -->
        <div class="qualterly">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Quarterly</mat-label>
            <mat-select [(ngModel)]="selectedQuarterYear">
              <mat-option *ngFor="let year of years" [value]="year">{{ year }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      
        <!-- Yearly Selection -->
        <div class="Yearly">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Yearly</mat-label>
            <mat-select [(ngModel)]="selectedYear">
              <mat-option *ngFor="let year of years" [value]="year">{{ year }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
        <div class="monthly-checkbox">
            <mat-checkbox [(ngModel)]="showMonthly">Monthly</mat-checkbox>
          </div>
      
        <!-- Monthly Selection -->
        <div class="monthly">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Select Month</mat-label>
            <mat-select [(ngModel)]="selectedMonth">
              <mat-option *ngFor="let month of months" [value]="month.value">{{ month.name }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>      
  </div>

<table class="styled-table" *ngIf="!isFilterApplied()">
  <thead>
    <tr><th>Client Partner (CP)</th><th>LOB</th><th>Delivery Manager (DM)</th><th>Count</th><th>Start Date</th><th>End Date</th></tr>
  </thead>
  <tbody>
    <tr *ngFor="let row of candidateSelectionTable">
      <td>{{ row.cp }}</td><td>{{ row.lob }}</td><td>{{ row.dm }}</td><td>{{ row.count }}</td><td>{{ row.startDate }}</td><td>{{ row.endDate }}</td>
    </tr>
  </tbody>
</table>

<ng-container *ngIf="isFilterApplied()">
  <div *ngFor="let lobData of filteredTables" class="lob-table">
    <h3>{{ lobData.lob }}</h3>
    <table class="styled-table">
      <thead><tr><th>CP</th><th>DM</th><th>LOB</th><th *ngFor="let month of lobData.months">{{ month }}</th></tr></thead>
      <tbody>
        <tr *ngFor="let row of lobData.data">
          <td>{{ row.cp }}</td><td>{{ row.dm }}</td><td>{{ row.lob }}</td><td *ngFor="let value of row.values">{{ value }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</ng-container>
