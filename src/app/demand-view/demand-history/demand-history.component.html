<div class="history-wrapper">
  <div class="header">
    <h3>Demand History</h3>
    <button mat-button (click)="closeHistory()">Close</button>
  </div>

  <div *ngIf="demandHistoryData.length > 0; else noData">
    <ng-container *ngFor="let item of demandHistoryData; let i = index">
      <!-- Check if date is different from previous -->
      <ng-container *ngIf="i === 0 || (item.date | date: 'mediumDate') !== (demandHistoryData[i - 1]?.date | date: 'mediumDate')">
        <div class="date-break">
          <hr />
          <div class="date-section">
            {{ item.date | date: 'fullDate' }}
          </div>
        </div>
      </ng-container>
  
      <div class="entry-content">
        <mat-icon class="entry-icon">history</mat-icon>
        <div class="text-block">
          <p class="message">{{ item.message }}</p>
          <p class="time">{{ item.date | date: 'mediumTime' }}</p>
          <p class="updated-by">
            Updated by: {{ item.history.updateby_emp_id }}
          </p>
        </div>
      </div>
  
      <div class="break"></div>
    </ng-container>
  </div>      

  <ng-template #noData>
    <div class="no-data">No history available.</div>
  </ng-template>
</div>