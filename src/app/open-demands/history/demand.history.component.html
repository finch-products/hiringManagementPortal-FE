<div class="history-container">
  <!-- Sidebar -->
  <aside class="sidebar">
    <!-- <div class="custom-search-box">
      <input type="text" (keyup)="applyFilter($event)"
          placeholder="Search ..." />
      <mat-icon class="search-icon">search</mat-icon>
  </div> -->


    <div class="search-container">
      <div class="custom-search-box">
        <input type="text"  [(ngModel)]="searchText"
            placeholder="Search ..." />
        <mat-icon class="search-icon">search</mat-icon>
    </div>


      <!-- <mat-form-field appearance="outline">
        <mat-icon matPrefix>search</mat-icon>
        <input matInput placeholder="Search" [(ngModel)]="searchText" />
      </mat-form-field> -->
    </div>

    <!-- Demand List with Scrollbar -->
    <div class="demands-list">
      <h3>Demands</h3>
      <mat-list class="scrollable-list">
        <mat-list-item
        *ngFor="let demand of filteredDemands()"
        (click)="selectDemand(demand.dem_id)"
        [ngClass]="{'selected-demand': selectedDemandId === demand.dem_id}">
        {{ demand.dem_id }}
      </mat-list-item>
      
      </mat-list>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="content">
    <mat-card *ngIf="selectedDemand">
      <mat-card-title>Demand Details</mat-card-title>
      <mat-card-content>
        <p><strong>CTool Number:</strong> {{ selectedDemand?.dem_ctoolnumber }}</p>
        <p><strong>CTool Date:</strong> {{ selectedDemand?.dem_ctooldate }}</p>
        <p><strong>Position Name:</strong> {{ selectedDemand?.dem_position_name }}</p>
        <p><strong>Valid Till:</strong> {{ selectedDemand?.dem_validtill }}</p>
        <p><strong>Skillset:</strong> {{ selectedDemand?.dem_skillset }}</p>
        <p><strong>No Of Positions:</strong> {{ selectedDemand?.dem_positions }}</p>
        <p><strong>RR Number:</strong> {{ selectedDemand?.dem_rrnumber }}</p>
        <p><strong>JR Number:</strong> {{ selectedDemand?.dem_jrnumber }}</p>
        <p><strong>RR Grade:</strong> {{ selectedDemand?.dem_rrgade }}</p>
        <p><strong>GCB Level:</strong> {{ selectedDemand?.dem_gcblevel }}</p>
        <p><strong>Comments:</strong> {{ selectedDemand?.dem_comment }}</p>
        <p><strong>Is Reopened:</strong> {{ selectedDemand?.dem_isreopened ? 'Yes' : 'No' }}</p>
        <p><strong>Active:</strong> {{ selectedDemand?.dem_isactive ? 'Yes' : 'No' }}</p>
    
        <!-- Foreign Key Details -->
    <p><strong>Client Name:</strong> {{ selectedDemand?.client_details?.clm_name }}</p>
    <p><strong>Location:</strong> {{ selectedDemand?.location_details?.lcm_name }}</p>
    <p><strong>LOB Name:</strong> {{ selectedDemand?.lob_details?.lob_name }}</p>
    <p><strong>Department:</strong> {{ selectedDemand?.department_details?.idm_unitname }}</p>
    <p><strong>Status:</strong> {{ selectedDemand?.status_details?.dsm_description }}</p>
      </mat-card-content>
    </mat-card>
    

    <mat-card *ngFor="let candidate of candidates">
      <mat-card-title>Candidate Details</mat-card-title>
      <mat-card-content>
        <p><strong>Candidate Name:</strong> {{ candidate.name }}</p>
        <p><strong>Email:</strong> {{ candidate.email }}</p>
        <p><strong>Phone:</strong> {{ candidate.phone }}</p>
        <p><strong>Location:</strong> {{ candidate.location_name }}</p>
        <p><strong>Description:</strong> {{ candidate.description }}</p>
        <p><strong>keywords :</strong> {{ candidate.keywords}}</p>
        <p><strong>Skills:</strong> {{ candidate.keywords || 'Not Provided' }}</p>
        <p><strong>Date Of Joining:</strong> {{ candidate.cdl_joiningdate || 'TBD' }}</p>
      </mat-card-content>
    </mat-card>

    <mat-card *ngIf="selectedDemand">
      <mat-card-title>Job Description</mat-card-title>
      <mat-card-content>
        <p><strong>Job Description:</strong> <a [href]="selectedDemand?.dem_jd" target="_blank"> View Job Description</a></p>
      </mat-card-content>
    </mat-card>
  </div>
</div>